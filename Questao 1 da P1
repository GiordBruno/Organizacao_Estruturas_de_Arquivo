#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#pragma pack(1)
struct registro{
    char chave[8];
    char nome[40];
    char email[40];
    char telefone[12];
    char quebra[1];
};

int main(){
 struct registro r[7] = {{"10","Armando","gmail.com","147"},
                         {"11","Eni","yahoo.com.br","258"},
                         {"12","Elias","uol.com.br","369"},
                         {"13","Luzia","uol.com.br","147"},
                         {"14","Pedro","gmail.com","369"},
						 {"15","Rena","yahoo.com.br","147"},
                         {"16","Eunice","uol.com.br","369"}};
                    

 int i=0,qt; 
 printf("Tamanho da estrutura %d\n\n",sizeof(struct registro));
 int primeiro,meio,ultimo,posicao;                       
 FILE *a,*saida;
 
 /*Abrindo o arquivo para escrita*/
 a=fopen("arq1.dat","w");
 fwrite(&r,sizeof(struct registro),8,a);
 
 /*Fechando o arquivo*/
 fclose(a);
 
 /*Abrindo o arquivo'a'para leitura e o arquivo 'saida' para escrita*/
 a = fopen("arq1.dat","r");
 saida = fopen("arq2.dat","w");
 
 /*calculando tamanho do registro em byte e em quantidade de registros*/
 fseek(a,0,SEEK_END);
 printf("Tamanho do arquivo 'arq1' em bytes %ld\n",ftell(a));
 printf("Quantidade de registros no arquivo 'arq1' %ld\n\n",ftell(a)/sizeof(struct registro));
 ultimo = (ftell(a)/sizeof(struct registro))-1;
 
 /*Lendo o arquivo 'a' do ultimo registro para o primeiro e escrendo no arquivo 'saida'.*/ 
//fseek(a,ultimo*sizeof(struct aluno),SEEK_SET);
printf("ultimo %d\n",ultimo);
 
 while(ultimo>=0){
 	fseek(a,ultimo*sizeof(struct registro),SEEK_SET);
 	fread(&r,sizeof(struct registro),1,a);
 	fwrite(&r,sizeof(struct registro),1,saida);
 	--ultimo;
 }
 
 fclose(a);
}
